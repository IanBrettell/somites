include: "rules/00_common.smk"

##### Target rules #####


rule all:
    input:
################
# 00_common.smk
################    
#        config["F2_samples"]
################
# 01_ref.smk
################
#        config["ref_prefix"] + ".fasta",
#        config["ref_prefix"] + ".fasta.fai",
#        config["ref_prefix"] + ".dict",
#        # F0
#        expand(os.path.join(config["working_dir"], "sams/F0/mapped/{sample}-{unit}.sam"),
#                zip,
#                sample = samples['sample'],
#                unit = samples['unit']
#        ),
#        expand(os.path.join(config["working_dir"], "sams/F0/grouped/{sample}-{unit}.sam"),
#                zip,
#                sample = samples['sample'],
#                unit = samples['unit']
#        ),
#        expand(os.path.join(config["working_dir"], "bams/F0/sorted/{sample}-{unit}.bam"),
#                zip,
#                sample = samples['sample'],
#                unit = samples['unit']
#        ),
#        expand(os.path.join(config["working_dir"], "bams/F0/marked/{sample}-{unit}.bam"),
#                zip,
#                sample = samples['sample'],
#                unit = samples['unit']                
#        ),
#        expand(os.path.join(config["working_dir"], "bams/F0/merged/{sample}.bam"),
#                sample = list(set(samples['sample']))
#        ),
#        expand(os.path.join(config["working_dir"], "vcfs/F0/gvcfs/{sample}/{contig}.g.vcf"),
#                sample = list(set(samples['sample'])),
#                contig = get_contigs(),
#        ),
#        expand(os.path.join(config["working_dir"], "vcfs/F0/combined/all.{contig}.g.vcf.gz"),
#                contig = get_contigs(),
#        ),
#        expand(os.path.join(config["working_dir"], "vcfs/F0/genotyped/all.{contig}.vcf.gz"),
#                contig = get_contigs(),
#        ),
#        expand(os.path.join(config["working_dir"], "vcfs/F0/final/all.vcf.gz")),
################
# 04_F2_mapping.smk
################
#        expand(os.path.join(config["working_dir"], "sams/F2/mapped/{sample}.sam"),
#                sample = F2_samples['LANE']
#        ),
#        expand(os.path.join(config["working_dir"], "bams/F2/bwamem2/sorted/{sample}.bam"),
#                sample = F2_samples['LANE']
#        ),
#        expand(os.path.join(config["working_dir"], "bams/F2/bwamem2/marked/{sample}.bam.bai"),
#                sample = F2_samples['LANE']
#        ),
################
# 05_F2_recomb_blocks.smk
################
#        expand(os.path.join(config["working_dir"], "data/sites_files/F0_Cab_Kaga/all_sites/{contig}.csv"),
#                contig = get_contigs()
#        ),
#        expand(os.path.join(config["working_dir"], "data/sites_files/F0_Cab_Kaga/divergent/{contig}.txt"),
#                contig = get_contigs()
#        ),
#        os.path.join(config["working_dir"], "data/sites_files/F0_Cab_Kaga/final/all.txt"),
#        expand(os.path.join(config["working_dir"], "dp4s/batch_01/bwamem2/{sample}.dp4.txt"),
#                sample = F2_samples['LANE']
#        ),
#        expand(os.path.join(config["working_dir"], "dpABs/batch_01/bwamem2/{sample}.txt"),
#                sample = F2_samples['LANE']
#        ),
        os.path.join(config["data_store_dir"], "hmm_output_batch_01.txt"),

##### Modules #####

include: "rules/01_ref.smk"
include: "rules/02_F0_mapping.smk"
include: "rules/03_F0_calling.smk"
include: "rules/04_F2_mapping.smk"
include: "rules/05_F2_recomb_blocks.smk"
