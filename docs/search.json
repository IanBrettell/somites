[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Somite periodicity notebook",
    "section": "",
    "text": "This notebook sets out the bioinformatic analysis of somite development periods, for Ali Ahmed Seleit in the Aulehla Group at EMBL Heidelberg.\n\n\n\n\n\nVideo by Ali Ahmed Seleit"
  },
  {
    "objectID": "02-phenotypes.html",
    "href": "02-phenotypes.html",
    "title": "1  Phenotypes of interest",
    "section": "",
    "text": "Figure 1.1 shows the period data generated by pyBOAT for this study, for 100 illustrative F2 samples over 300 minutes. The same data can be represented by boxplots as shown in Figure 1.2. I experimented with using the F2 individuals’ mean period and period intercept as the phenotype of interest. The two measures are highly correlated (\\(Pearson's~r =\\) 0.84, \\(p\\) < 2.2 x 10-16), so after displaying the distributions for both measures in Figure 1.4, I proceed to only discuss the analysis of period intercept, as it would appear to potentially be more robust to the changes in slope that can be observed in Figure 1.1.\n\n\n\n\n\nFigure 1.1: PyBOAT results for 100 illustrative F2 samples, showing the period length in minutes over the course of 300 minutes. Period tends to increase over time, meaning that as the embryo develops, each successive somite takes longer to form. Figure generated by Ali Seleit.\n\n\n\n\n\n\n\n\n\nFigure 1.2: Period measurements for 70 F2 individuals displayed as boxplots with each individual’s median and interquartile range. Figure generated by Ali Seleit."
  },
  {
    "objectID": "02-phenotypes.html#unsegmented-presomitic-mesoderm-area-psm",
    "href": "02-phenotypes.html#unsegmented-presomitic-mesoderm-area-psm",
    "title": "1  Phenotypes of interest",
    "section": "1.2 Unsegmented presomitic mesoderm area (PSM)",
    "text": "1.2 Unsegmented presomitic mesoderm area (PSM)\nIn the proceeding analyses, I also included a second phenotype of interest: the total area of the unsegmented tissue at the stage where 10-11 somites had been formed (PSM area). As the measure is simply based on the total number of pixels covered by the embryo object, I considered it to be potentially more robust than the period measurements, and therefore included it as a type of positive control for the genetic association analyses on the period phenotype. The measurements for PSM area comparing F0 Cab and Kaga strains are shown in Figure 1.3.\n\n\n\n\n\nFigure 1.3: Measurements of unsegmented PSM area in pixels for the F0 individuals from the Cab strain (\\(N = 19\\)) and Kaga strain (\\(N = 10\\)). Kaga tends to have a smaller PSM than Cab. Figure generated by Ali Seleit."
  },
  {
    "objectID": "02-phenotypes.html#comparisons-between-f0-f1-and-f2-generations",
    "href": "02-phenotypes.html#comparisons-between-f0-f1-and-f2-generations",
    "title": "1  Phenotypes of interest",
    "section": "1.3 Comparisons between F0, F1 and F2 generations",
    "text": "1.3 Comparisons between F0, F1 and F2 generations\nFigure 1.4 shows the distributions of the period intercept and unsegmented PSM area phenotypes across the F0, F1 and F2 generations. In relation to the period intercept phenotype, only the Cab strain in shown for F0 because only the Cab strain carries the reporter gene, which prohibited the collection of data for Kaga using this pyBOAT method. However, from previous bright field image analyses (which did not require the reporter), my collaborators determined that the Kaga strain has a lower (i.e. faster) period than Cab by around 10 minutes (see Figure @ref(fig:F0-Cab-Kaga-HdrR) in the Introduction). Given these differences, the F1 generation shows the expected intermediate median between the Cab and Kaga F0 strains. I also expected to observe that the F2 generation has a similar median to the F1 generation, but with a wider variance that spans across the extremes of the two F0 parental strains. Instead, I observed that the F2 generation has a median that is slightly slower than the median of the slower-period F0 Cab strain. My collaborators assured me that these observations were unlikely to be caused by technical issues. A possible biological explanation of this is that there are more genetic combinations that slow down the clock rather than speed it up (Sanchez et al. 2022; Schröter and Oates 2010). This phenomenon could be exacerbated by the fact that the Cab and Kaga strains originate from different Japanese medaka populations (southern and northern respectively), which are understood to be at the point of speciation (see Chapter @ref(MIKK-genomes-chap)), so this slower period may be driven by a biological incompatibility between their genomes in cases where they do not have a complete chromosome from each parent (as the F1 generation does). I nevertheless proceeded with the genetic analysis with a view to potentially discovering the reason for this unusual distribution.\n\n\nCode\nIN_F01 = here::here(\"data/F0_F1_period.xlsx\")\nIN_F2 = here::here(\"config/phenos_with_reporter_genoandpheno.csv\")\n\n########################\n# Plotting parameters\n########################\n\n# Intercept\nintercept_pal = c(\"#8D99AE\", \"#2b2d42\")\n\n# Mean\nmean_pal = c(\"#177E89\", \"#084C61\")\n\n# PSM\nunsegmented_psm_area_pal = c(\"#D9D0DE\", \"#401F3E\")\n\n# Get lighter/darker functions\n\ndevtools::source_gist(\"c5015ee666cdf8d9f7e25fa3c8063c99\")\n\n########################\n# Read in file\n########################\n\ndf_f2 = readr::read_delim(IN_F2, delim = \";\") %>% \n  # add `GEN` column\n  dplyr::mutate(GEN = \"F2\")\n\n\n# Read in F0 and F1 data\ndf_f01 = readxl::read_xlsx(IN_F01) %>% \n  dplyr::mutate(sample = fish) %>% \n  dplyr::mutate(GEN = dplyr::case_when(str_detect(fish, \"^C\") ~ \"F0\",\n                                       str_detect(fish, \"^K\") ~ \"F1\"))\n\n# Bind two data frames\ndf_all = dplyr::bind_rows(df_f01, df_f2) %>% \n  # factorise Microscope\n  dplyr::mutate(Microscope = factor(Microscope, levels = c(\"AU\", \"DB\")))\n\n########################\n# Kruskal-Wallis test\n########################\n\n## Difference in period intercept and mean between F2\n\n#df_all %>% \n#  # take only F2 individuals\n#  dplyr::filter(GEN == \"F2\") %>% \n#  # pivot longer to put phenotypes values in one column\n#  tidyr::pivot_longer(cols = c(mean, intercept, unsegmented_psm_area),\n#                      names_to = \"phenotype\",\n#                      values_to = \"value\") %>% \n#  dplyr::filter(phenotype %in% c(\"intercept\", \"mean\")) %>% \n#  dplyr::group_by(phenotype, Microscope) %>% \n#  dplyr::summarise(mean = mean(value))\n\nkw_df = df_all %>% \n  # take only F2 individuals\n  dplyr::filter(GEN == \"F2\") %>% \n  # pivot longer to put phenotypes values in one column\n  tidyr::pivot_longer(cols = c(mean, intercept, unsegmented_psm_area),\n                      names_to = \"phenotype\",\n                      values_to = \"value\") %>% \n  dplyr::group_by(phenotype) %>% \n  tidyr::nest() %>%\n  dplyr::mutate(model = purrr::map(data,\n                                   ~kruskal.test(x = .$value, g = .$Microscope))) %>%\n  dplyr::select(-data) %>% \n  dplyr::mutate(model_tidy = purrr::map(model, broom::tidy)) %>%\n  tidyr::unnest(model_tidy) %>% \n  rstatix::add_significance(p.col = \"p.value\") %>% \n  # remove model\n  dplyr::select(-model) %>% \n  # reduce to 3 digits\n  dplyr::mutate(p.value = signif(p.value, digits = 3)) %>% \n  # paste p-value with significance\n  dplyr::mutate(p_final = dplyr::case_when(p.value.signif == \"ns\" ~ paste(\"p =\", p.value),\n                                           TRUE ~ paste(\"p =\", p.value, p.value.signif))) %>% \n  # add `Microscope` column with 'DB' so that the text maps there on the plots\n  dplyr::mutate(Microscope = factor(\"DB\", levels = c(\"AU\", \"DB\")))\n\n########################\n# Plot\n########################\n\n########### Intercept\n\nintercept_fig = df_all %>% \n  # remove NAs\n  dplyr::filter(!is.na(Microscope)) %>% \n  ggplot(aes(GEN, intercept, fill = Microscope)) +\n  geom_violin() + \n  geom_boxplot(width = 0.3) +\n  ggbeeswarm::geom_beeswarm(aes(GEN, intercept, colour = Microscope), size = 0.4, alpha = 0.5) +\n  facet_grid(cols = vars(Microscope)) + \n  scale_colour_manual(values = lighter(intercept_pal, amount = 50)) +\n  scale_fill_manual(values = darker(intercept_pal, amount = 50)) +\n  cowplot::theme_cowplot() +\n  theme(strip.background.x = element_blank(),\n        strip.text.x = element_text(face = \"bold\")) +\n  xlab(\"generation\") +\n  ylab(\"period intercept (minutes)\") +\n  guides(fill = \"none\",\n         colour = \"none\") +\n  # add p-value\n  geom_text(data = kw_df %>% \n              dplyr::filter(phenotype == \"intercept\"),\n            aes(x = \"F2\", y = -Inf, label = p_final,\n                vjust = -1\n            ))\n\n########### PSM\n\npsm_fig = df_all %>% \n  # remove NAs\n  dplyr::filter(!is.na(Microscope)) %>% \n  ggplot(aes(GEN, unsegmented_psm_area, fill = Microscope)) +\n  geom_violin() + \n  geom_boxplot(width = 0.3) +\n  ggbeeswarm::geom_beeswarm(aes(GEN, unsegmented_psm_area, colour = Microscope), size = 0.4, alpha = 0.5) +\n  facet_grid(cols = vars(Microscope)) + \n  scale_colour_manual(values = lighter(unsegmented_psm_area_pal, amount = 50)) +\n  scale_fill_manual(values = darker(unsegmented_psm_area_pal, amount = 50)) +\n  cowplot::theme_cowplot() +\n  theme(strip.background.x = element_blank(),\n        strip.text.x = element_text(face = \"bold\")) +\n  xlab(\"generation\") +\n  ylab(\"unsegmented PSM area (pixels)\") +\n  guides(fill = \"none\",\n         colour = \"none\") +\n  # add p-value\n  geom_text(data = kw_df %>% \n              dplyr::filter(phenotype == \"unsegmented_psm_area\"),\n            aes(x = \"F2\", y = -Inf, label = p_final,\n                vjust = -1\n            ))\n\n\nperiod_final = cowplot::plot_grid(intercept_fig,\n                                  psm_fig,\n                                  align = \"hv\",\n                                  nrow = 2,\n                                  labels = c(\"A\", \"B\"),\n                                  label_size = 16)\n\nperiod_final\n\n\n\n\n\nFigure 1.4: Comparisons between the F0, F1 and F2 generations for period intercept and unsegmented PSM area. As only the Cab strain contains the reporter gene, the F0 only shows period intercept for Cab individuals (with the Kaga strain previously estimated to have a period of ~10 minutes slower than Cab). A: period intercept in minutes. B: unsegmented PSM area in pixels. \\(P\\)-values are derived from Kruskal-Wallis tests comparing the F2 individuals across microscopes. For unsegmented PSM area, data was only collected for the F2 generation.\n\n\n\n\n\n\n\n\n\nFigure 1.5: Comparisons between the F0, F1 and F2 generations for period intercept and unsegmented PSM area. As only the Cab strain contains the reporter gene, the F0 only shows period intercept for Cab individuals (with the Kaga strain previously estimated to have a period of ~10 minutes slower than Cab). A: period intercept in minutes. B: unsegmented PSM area in pixels. \\(P\\)-values are derived from Kruskal-Wallis tests comparing the F2 individuals across microscopes. For unsegmented PSM area, data was only collected for the F2 generation.\n\n\n\n\nAnother important issue to note is that the F2 individuals were sequenced using different microscopes of the same model (Zeiss LSM 780) but with different temperature control units and incubator boxes, denoted as ‘AU’ and ‘DB’.1 Our collaborators noticed that there was a difference between the microscopes in their temperatures of 0.7-0.8°C, translating to a 4-minute difference in the F2 means for the period intercept measure (Kruskal-Wallis = 177.97, \\(p\\) = 1.34 x 10-40), and a 3.5-minute difference in the F2 means for the period mean measure (Kruskal-Wallis = 141.79, \\(p\\) = 1.08 x 10-32). This difference would need to be accounted for in the downstream analysis through either adjusting the phenotype prior to running the genetic association model, or by including microscope as a covariate in the model. For unsegmentated PSM area, I did not find a significant difference between microscopes, so I determined that it was not necessary to control for microscope in the downstream analysis for this phenotype.\n\n1.3.0.1 Inverse-normalisation\nTo resolve this difference between microscopes for the period intercept data, I elected to transform it for the F2 generation by “inverse-normalising” the period intercept within each microscope (Figure 1.6), and used this transformed phenotype for the downstream analysis. Inverse-normalisation is a rank-based normalisation approach which involves replacing the values in the phenotype vector with their rank (where ties are averaged), then converting the ranks into a normal distribution with the quantile function (Wichura 1988). The inverse-normalisation function I used for this analysis is set out in the following R code:\n\n\nCode\ninvnorm = function(x) {\n  res = rank(x)\n  # The arbitrary 0.5 value is added to the denominator below \n  # to avoid `qnorm()` returning 'Inf' for the last-ranked value\n  res = qnorm(res/(length(res)+0.5))\n  return(res)\n}\n\n\n\n\n\n\n\nFigure 1.6: Comparison of the period intercept phenotype data for the F2 generation before (A) and after (B) inverse-normalisation, with vertical lines marking the mean of each group.\n\n\n\n\n\n\n\n\nSanchez, Paul Gerald Layague, Victoria Mochulska, Christian Mauffette Denis, Gregor Mönke, Takehito Tomita, Nobuko Tsuchida-Straeten, Yvonne Petersen, Katharina F. Sonnen, Paul François, and Alexander Aulehla. 2022. “Arnold Tongue Entrainment Reveals Dynamical Principles of the Embryonic Segmentation Clock.” bioRxiv. https://doi.org/10.1101/2021.10.20.465101.\n\n\nSchröter, Christian, and Andrew C. Oates. 2010. “Segment Number and Axial Identity in a Segmentation Clock Period Mutant.” Current Biology 20 (14): 1254–58. https://doi.org/10.1016/j.cub.2010.05.071.\n\n\nWichura, Michael J. 1988. “Algorithm AS 241: The Percentage Points of the Normal Distribution.” Journal of the Royal Statistical Society. Series C (Applied Statistics) 37 (3): 477–84. https://doi.org/10.2307/2347330."
  }
]